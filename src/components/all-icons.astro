---
import { Icon } from "astro-icon/components";

import { join } from "path";
import { readdirSync } from "fs";

const iconsDirectory = join(process.cwd(), "src", "icons");

function getIconNames(dir: string): string[] {
  const items = readdirSync(dir, { withFileTypes: true });
  return items.flatMap(item => {
    const fullPath = join(dir, item.name);
    if (item.isDirectory()) {
      return getIconNames(fullPath).map(subItem => `${item.name}/${subItem}`);
    } else if (item.name.endsWith(".svg")) {
      return item.name.replace(".svg", "");
    }
    return [];
  });
}

const iconNames = getIconNames(iconsDirectory);
---

<section
  class="flex max-w-screen-xl flex-wrap items-center gap-4 p-8 py-8 text-3xl md:mx-auto"
>
  {
    iconNames
      .filter(name => name !== "instagram")
      .map(name => <Icon name={name} />)
  }
</section>
